<div class="flex-1 min-w-0">
  <h2 class="text-xl font-bold text-center mb-4 text-slate-700 dark:text-slate-100">稼働時間計算</h2>
  <div class="bg-white/80 dark:bg-slate-800/90 backdrop-blur-sm p-6 rounded-2xl shadow-lg dark:shadow-slate-900/50 border border-slate-200/50 dark:border-slate-700/50">
    <form method="get" action="<%= analytics_path %>" class="space-y-4">
      <div>
        <label for="total_hours_user1" class="block text-sm font-semibold text-slate-700 dark:text-slate-200 mb-2">User1の累計稼働時間（h）</label>
        <input type="number" step="0.01" name="total_hours_user1" id="total_hours_user1" value="<%= calculator.hours_u1 %>" class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-100 focus:ring-2 focus:ring-indigo-500 dark:focus:ring-cyan-500 focus:border-transparent transition-all text-[15px]">
      </div>
      <div>
        <label for="total_hours_user2" class="block text-sm font-semibold text-slate-700 dark:text-slate-200 mb-2">User2の累計稼働時間（h）</label>
        <input type="number" step="0.01" name="total_hours_user2" id="total_hours_user2" value="<%= calculator.hours_u2 %>" class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-100 focus:ring-2 focus:ring-indigo-500 dark:focus:ring-cyan-500 focus:border-transparent transition-all text-[15px]">
      </div>
      <div>
        <label for="subtract_days" class="block text-sm font-semibold text-slate-700 dark:text-slate-200 mb-2">営業日数から減らす日数（有給等）</label>
        <input type="number" name="subtract_days" id="subtract_days" value="<%= calculator.subtract_days %>" min="0" class="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-100 focus:ring-2 focus:ring-indigo-500 dark:focus:ring-cyan-500 focus:border-transparent transition-all text-[15px]">
      </div>
      <div class="flex gap-2">
        <button type="submit" class="px-5 py-2 bg-indigo-500 dark:bg-cyan-600 text-white rounded-lg hover:bg-indigo-600 dark:hover:bg-cyan-700 transition-colors font-semibold text-sm shadow-md hover:shadow-lg">計算</button>
        <button type="submit" name="calculate_until" value="yesterday" class="px-5 py-2 bg-slate-500 dark:bg-slate-600 text-white rounded-lg hover:bg-slate-600 dark:hover:bg-slate-500 transition-colors font-semibold text-sm shadow-md hover:shadow-lg">昨日の日付で計算</button>
      </div>
    </form>

    <div class="mt-6 overflow-hidden rounded-xl border border-slate-200 dark:border-slate-700">
      <table class="w-full text-sm">
        <tbody class="divide-y divide-slate-200 dark:divide-slate-700">
          <tr class="bg-slate-50 dark:bg-slate-700/50">
            <td class="px-4 py-3 font-medium text-slate-600 dark:text-slate-300">日付</td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.today_formatted %></td>
          </tr>
          <tr>
            <td class="px-4 py-3 font-medium text-slate-600 dark:text-slate-300">営業日数</td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200">
              <%= calculator.business_days %> 日
              <% if calculator.subtract_days > 0 %>
              <span class="ml-2 text-xs text-slate-500 dark:text-slate-400">（-<%= calculator.subtract_days %>日 → <%= calculator.business_days_adjusted %>日）</span>
              <% end %>
            </td>
          </tr>
          <tr class="bg-slate-50 dark:bg-slate-700/50">
            <td class="px-4 py-3 font-medium text-slate-600 dark:text-slate-300">残り営業日数</td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.remaining_days %> 日</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-base mt-4 text-slate-600 dark:text-slate-300">累計稼働時間： <span class="font-bold text-indigo-600 dark:text-cyan-400"><%= calculator.current_total.round(1) %> h</span><span class="text-xs ml-1 text-slate-500 dark:text-slate-400">(現在)</span></p>

    <div class="mt-4 overflow-hidden rounded-xl border border-slate-200 dark:border-slate-700">
      <table class="w-full text-sm">
        <thead>
          <tr class="bg-slate-100 dark:bg-slate-700/50">
            <th class="px-4 py-3 text-left font-bold text-slate-700 dark:text-slate-200">項目</th>
            <th class="px-4 py-3 text-center font-bold text-slate-700 dark:text-slate-200">User1</th>
            <th class="px-4 py-3 text-center font-bold text-slate-700 dark:text-slate-200">User2</th>
            <th class="px-4 py-3 text-center font-bold text-slate-700 dark:text-slate-200">合計</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-200 dark:divide-slate-700 text-center">
          <tr>
            <td class="px-4 py-3 text-left text-slate-600 dark:text-slate-300">
              <span>稼働時間</span>
              <span class="ml-1 text-xs text-slate-500 dark:text-slate-400">(h/日)</span>
            </td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.per_day_u1.round(1) %></td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.per_day_u2.round(1) %></td>
            <td class="px-4 py-3 font-bold text-indigo-600 dark:text-cyan-400"><%= (calculator.per_day_u1 + calculator.per_day_u2).round(1) %></td>
          </tr>
          <tr class="bg-slate-50 dark:bg-slate-700/30">
            <td class="px-4 py-3 text-left text-slate-600 dark:text-slate-300">
              <span>増加予測</span>
              <span class="ml-1 text-xs text-slate-500 dark:text-slate-400">(h/月)</span>
            </td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.predicted_u1.round(1) %></td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.predicted_u2.round(1) %></td>
            <td class="px-4 py-3 font-bold text-indigo-600 dark:text-cyan-400"><%= (calculator.predicted_u1 + calculator.predicted_u2).round(1) %></td>
          </tr>
          <tr class="border-t-2 border-slate-300 dark:border-slate-600">
            <td class="px-4 py-3 text-left text-slate-600 dark:text-slate-300">
              <span>累計予測</span>
              <span class="ml-1 text-xs text-slate-500 dark:text-slate-400">(h/月)</span>
            </td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.final_u1.round(1) %></td>
            <td class="px-4 py-3 text-slate-700 dark:text-slate-200"><%= calculator.final_u2.round(1) %></td>
            <td class="px-4 py-3 font-bold text-lg text-emerald-600 dark:text-emerald-400"><%= calculator.total_final.round(1) %></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-base mt-4 text-slate-600 dark:text-slate-300">累計稼働時間： <span class="font-bold text-emerald-600 dark:text-emerald-400"><%= calculator.total_final.round(1) %> h</span><span class="text-xs ml-1 text-slate-500 dark:text-slate-400">(予測)</span></p>
  </div>
</div>
